<ion-header>
	<ion-toolbar>
		<ion-title>{{ "profile.CHANGE_PW" | translate }}</ion-title>
		<ion-buttons slot="end">
			<ion-button (click)="onCancel()"
				><ion-icon slot="icon-only" name="close-outline"></ion-icon
			></ion-button>
		</ion-buttons>
	</ion-toolbar>
</ion-header>

<ion-content class="change-pw-content">
	<div class="ion-text-center ion-margin-top ion-margin-bottom">
		<ion-text>
			<ion-label>{{ "profile.CHANGE_PW_MSG" | translate }}</ion-label>
		</ion-text>
	</div>
	<form [formGroup]="changePasswordForm" (ngSubmit)="onChangePassword()">
		<ion-list class="inputs-list" lines="full">
			<ion-item class="input-item">
				<app-show-hide-password>
					<ion-input
						type="password"
						[placeholder]="'fields.CURRENT_PW' | translate"
						formControlName="currentPassword"
					></ion-input>
				</app-show-hide-password>
			</ion-item>
			<div class="error-container">
				<ng-container
					*ngFor="
						let validation of validation_messages.currentPassword
					"
				>
					<div
						class="error-message"
						*ngIf="
							changePasswordForm
								.get('currentPassword')
								.hasError(validation.type) &&
							(changePasswordForm.get('currentPassword').dirty ||
								changePasswordForm.get('currentPassword')
									.touched)
						"
					>
						<ion-icon name="information-circle-outline"></ion-icon>
						<span>{{ validation.message }}</span>
					</div>
				</ng-container>
			</div>
			<div formGroupName="matchingPasswords">
				<ion-item class="input-item">
					<app-show-hide-password>
						<ion-input
							type="password"
							[placeholder]="'fields.NEW_PW' | translate"
							formControlName="newPassword"
						></ion-input>
					</app-show-hide-password>
				</ion-item>
				<div class="error-container">
					<ng-container
						*ngFor="
							let validation of validation_messages.newPassword
						"
					>
						<div
							class="error-message"
							*ngIf="
								changePasswordForm
									.get('matchingPasswords')
									.get('newPassword')
									.hasError(validation.type) &&
								(changePasswordForm
									.get('matchingPasswords')
									.get('newPassword').dirty ||
									changePasswordForm
										.get('matchingPasswords')
										.get('newPassword').touched)
							"
						>
							<ion-icon
								name="information-circle-outline"
							></ion-icon>
							<span>{{ validation.message }}</span>
						</div>
					</ng-container>
				</div>

				<ion-item class="input-item">
					<app-show-hide-password>
						<ion-input
							type="password"
							[placeholder]="'fields.CONFIRM_PW' | translate"
							formControlName="confirmNewPassword"
						></ion-input>
					</app-show-hide-password>
				</ion-item>
				<div class="error-container">
					<ng-container
						*ngFor="
							let validation of validation_messages.confirmNewPassword
						"
					>
						<div
							class="error-message"
							*ngIf="
								changePasswordForm
									.get('matchingPasswords')
									.get('confirmNewPassword')
									.hasError(validation.type) &&
								(changePasswordForm
									.get('matchingPasswords')
									.get('confirmNewPassword').dirty ||
									changePasswordForm
										.get('matchingPasswords')
										.get('confirmNewPassword').touched)
							"
						>
							<ion-icon
								name="information-circle-outline"
							></ion-icon>
							<span>{{ validation.message }}</span>
						</div>
					</ng-container>
				</div>
			</div>
			<div class="error-container">
				<ng-container
					*ngFor="
						let validation of validation_messages.matchingPasswords
					"
				>
					<div
						class="error-message"
						*ngIf="
							changePasswordForm
								.get('matchingPasswords')
								.hasError(validation.type) &&
							(changePasswordForm
								.get('matchingPasswords')
								.get('confirmNewPassword').dirty ||
								changePasswordForm
									.get('matchingPasswords')
									.get('confirmNewPassword').touched)
						"
					>
						<ion-icon name="information-circle-outline"></ion-icon>
						<span>{{ validation.message }}</span>
					</div>
				</ng-container>
			</div>
		</ion-list>
		<ion-button
			class="ion-margin-top"
			expand="block"
			fill="solid"
			color="primary"
			[disabled]="!changePasswordForm.valid"
			type="submit"
		>
			{{ "profile.CHANGE_PW" | translate }}</ion-button
		>
	</form>
</ion-content>
